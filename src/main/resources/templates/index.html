<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>Campus Compass</title>

    <style>
        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            font-family: 'Pretendard', sans-serif;
            background: #f5f7fb;
        }

        .header {
            width: 100%;
            padding: 15px 20px;
            display: flex; align-items: center; justify-content: space-between;
            background: #ffffff;
            font-size: 20px; font-weight: bold;
            color: #1d4ed8;
        }

        .home-icon { font-size: 22px; cursor: pointer; }

        .search-wrapper { width: 100%; padding: 10px 20px; }

        .search-box {
            width: 100%; height: 45px;
            padding: 0 15px; border-radius: 12px;
            border: 1px solid #d0d5dd;
        }

        /* ì¹´í…Œê³ ë¦¬ */
        .category-container {
            display: flex; flex-wrap: wrap;
            gap: 8px; padding: 0 20px;
        }

        .category-btn {
            padding: 8px 14px; border-radius: 40px;
            background: #ffffff; border: 1px solid #d1d5db;
            font-size: 14px; cursor: pointer;
            display: flex; align-items: center; gap: 6px;
        }

        .category-btn.active {
            background: #1d4ed8; color: white; border: none;
        }

        #map-wrapper {
            width: calc(100% - 40px);
            height: calc(100% - 260px);
            margin: 15px auto;
            border-radius: 14px;
            overflow: hidden;
            background: white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
        }

        #map { width: 100%; height: 100%; }

        /* ìƒì„¸ íŒ¨ë„ */
        #detail-panel-bg {
            position: fixed; width: 100%; height: 100%;
            background: rgba(0,0,0,0.25); display: none;
            top: 0; left: 0; z-index: 9998;
        }

        #detail-panel {
            position: fixed; bottom: 0; width: 100%;
            max-height: 65%; background: white;
            padding: 20px; border-radius: 20px 20px 0 0;
            transform: translateY(100%);
            transition: .3s;
            z-index: 9999; overflow-y: auto;
        }

        #detail-panel.open { transform: translateY(0); }
        .close-btn { position: absolute; right:18px; top:14px; cursor:pointer; }
        .floor-title { margin-top:12px; font-weight:bold; cursor:pointer; }
        .floor-content { display:none; margin-left:10px; }
    </style>
</head>

<body>

<div class="header">
    Campus Compass
    <div class="home-icon" onclick="location.href='/login'">ğŸ </div>
</div>

<div class="search-wrapper">
    <input type="text" class="search-box" placeholder="ì‹œì„¤ëª… ê²€ìƒ‰...">
</div>

<!-- ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ -->
<div class="category-container">
    <div class="category-btn active" data-category="ì „ì²´">ğŸ§­ ì „ì²´</div>
    <div class="category-btn" data-category="ì‹ë‹¹">ğŸ´ ì‹ë‹¹</div>
    <div class="category-btn" data-category="ë„ì„œê´€">ğŸ“š ë„ì„œê´€</div>
    <div class="category-btn" data-category="í¸ì˜ì ">ğŸª í¸ì˜ì </div>
    <div class="category-btn" data-category="íœ´ê²Œì‹¤">ğŸ›‹ íœ´ê²Œì‹¤</div>
    <div class="category-btn" data-category="ì˜ë¬´ì‹¤">â›‘ ì˜ë¬´ì‹¤</div>
    <div class="category-btn" data-category="í†µí•™ë²„ìŠ¤">ğŸšŒ í†µí•™ë²„ìŠ¤</div>
</div>

<div id="map-wrapper"><div id="map"></div></div>

<div id="detail-panel-bg"></div>
<div id="detail-panel"></div>

<script src="http://dapi.kakao.com/v2/maps/sdk.js?appkey=62ce24f8a9799f9545de678f7cd4fb4c"></script>

<script>
    var map = new kakao.maps.Map(document.getElementById("map"), {
        center: new kakao.maps.LatLng(36.8392, 127.1835),
        level: 3
    });

    /* ---------------------------
     * 1) ê±´ë¬¼ ì •ë³´ + ì¹´í…Œê³ ë¦¬ ì •ì˜
     * --------------------------- */
    var buildings = [
        { name:"ë°±ì„ìƒí™œê´€", lat:36.8424168681, lng:127.1852456685, categories:["ì‹ë‹¹"] },
        { name:"ì˜ˆìˆ ë™", lat:36.8388450253, lng:127.1874568021, categories:["í¸ì˜ì "] },
        { name:"êµìˆ˜íšŒê´€", lat:36.8396872448, lng:127.1847794352, categories:["ì‹ë‹¹","í¸ì˜ì "] },
        { name:"ëª©ì–‘ê´€", lat:36.8408468980, lng:127.1836611108, categories:["íœ´ê²Œì‹¤"] },
        { name:"í†µí•™ë²„ìŠ¤ ìŠ¹ì°¨ì¥", lat:36.8416229519, lng:127.1829454463, categories:["í†µí•™ë²„ìŠ¤"] },
        { name:"ì¸ì„±ê´€", lat:36.8393873031, lng:127.1835343004, categories:["ATM"] },
        { name:"ë³¸ë¶€ë™", lat:36.8393159970, lng:127.1859304639, categories:["ë„ì„œê´€"] },
        { name:"ì§„ë¦¬ê´€", lat:36.8402057267, lng:127.1845564615, categories:["í¸ì˜ì ","ì˜ë¬´ì‹¤"] }
    ];

    /* ë§ˆì»¤ ì €ì¥ */
    var markers = [];

    function createMarker(b) {
        var m = new kakao.maps.Marker({
            position: new kakao.maps.LatLng(b.lat, b.lng),
            map: map
        });

        kakao.maps.event.addListener(m, "click", function () {
            showDetailPanel(b.name);
        });

        markers.push({ marker: m, data: b });
    }

    buildings.forEach(b => createMarker(b));

    /* ì¹´í…Œê³ ë¦¬ í•„í„°ë§ */
    document.querySelectorAll(".category-btn").forEach(btn => {
        btn.addEventListener("click", function () {
            document.querySelectorAll(".category-btn").forEach(b => b.classList.remove("active"));
            this.classList.add("active");

            const category = this.dataset.category;
            filterMarkers(category);
        });
    });

    function filterMarkers(category) {
        markers.forEach(obj => {
            if (category === "ì „ì²´" || obj.data.categories.includes(category)) {
                obj.marker.setMap(map);
            } else {
                obj.marker.setMap(null);
            }
        });
    }

    /* ---------------------------
     * 3) ìƒì„¸ íŒ¨ë„ ê¸°ëŠ¥ (ê°€ìŠ¤í í•˜ìš°ìŠ¤ í´ë¦­ ì‹œ detail.html ì´ë™)
     * --------------------------- */
    var buildingDetails = {
        "ë³¸ë¶€ë™": {
            floors: {
                "ì§€í•˜ 1ì¸µ": [
                    "ê°€ìŠ¤í í•˜ìš°ìŠ¤",
                    "í‰ì¼ 08:00-19:00",
                    "í•™ìƒë“¤ì—ê²Œ ì‹œì‚¬ì™€ ì°¨, ìŒë£Œ ë“±ì„ ì €ë ´í•œ ê°€ê²©ìœ¼ë¡œ ê³µê¸‰í•˜ê³  ìˆìŠµë‹ˆë‹¤."
                ],
                "1ì¸µ": [
                    "ë„ì„œê´€",
                    "í‰ì¼ 09:00-18:00",
                    "í•™ìƒë“¤ì´ ì¸í„°ë„· ê²€ìƒ‰ì´ë‚˜ ìë£Œ íƒìƒ‰ì„ í•  ìˆ˜ ìˆëŠ” ê³³ì…ë‹ˆë‹¤."
                ],
                "3~9ì¸µ": [
                    "ë¼ìš´ì§€",
                    "24ì‹œê°„",
                    "í•™ìƒë“¤ì´ ì‰¬ê±°ë‚˜ ê°œì¸ ê³µë¶€ë¥¼ í•  ìˆ˜ ìˆëŠ” ê°œë°©í˜• ê³µê°„ì…ë‹ˆë‹¤."
                ],
                "5ì¸µ": [
                    "ë§¥ì‹¤ìŠµì‹¤",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-620-9714",
                    "MAC ê¸°ë°˜ ì‘ì—… í™˜ê²½ì´ êµ¬ì¶•ë˜ì–´ ë””ìì¸ ë° ì˜ìƒ ê´€ë ¨ ì‘ì—…ì— í™œìš©ë©ë‹ˆë‹¤."
                ],
                "6,8ì¸µ": [
                    "ë³µì‚¬ê¸°",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-550-0722",
                    "í•™ìƒë“¤ì˜ ë¬¸ì„œ ì¶œë ¥ê³¼ ë³µì‚¬ ì‘ì—…ì„ ë¹ ë¥´ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                ],
                "6ì¸µ": [
                    "ë§¤ì ",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-620-9509",
                    "ê°„ì‹ë¥˜, ìŒë£Œ, ë¬¸êµ¬ë¥˜ ë“±ì„ êµ¬ë§¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                ]
            }
        },

        "ë°±ì„ìƒí™œê´€": {
            floors: {
                "1ì¸µ": [
                    "ì‹ë‹¹",
                    "í‰ì¼ 07:30-09:00, 11:30-13:00, 17:30-19:00",
                    "ì „í™”ë²ˆí˜¸: 010-8805-1215",
                    "í•™ìƒë“¤ì—ê²Œ ì˜ì–‘ì„ ê³ ë ¤í•œ ì‹ì‚¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤."
                ]
            }
        },

        "ì˜ˆìˆ ë™": {
            floors: {
                "1,7ì¸µ": [
                    "ë³µì‚¬ê¸°",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-561-0722",
                    "ë””ìì¸ ì¶œë ¥ì´ë‚˜ ì¼ë°˜ ë¬¸ì„œ ì‘ì—…ì— ì‚¬ìš©ë©ë‹ˆë‹¤."
                ],
                "5ì¸µ": [
                    "ë§¤ì ",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-620-9679",
                    "ê°„ì‹ë¥˜, ìŒë£Œ, ë¬¸êµ¬ë¥˜ ë“±ì„ íŒë§¤í•©ë‹ˆë‹¤."
                ]
            }
        },

        "êµìˆ˜íšŒê´€": {
            floors: {
                "1ì¸µ": [
                    "ì‹ë‹¹",
                    "í‰ì¼ 11:30-13:30, 17:00-19:00",
                    "ì „í™”ë²ˆí˜¸: 041-620-9578",
                    "í•™êµ êµ¬ì„±ì›ë“¤ì—ê²Œ ê· í˜• ì¡íŒ ì‹ì‚¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤."
                ,
                    "ë§¤ì ",
                    "í‰ì¼ 09:00-18:00",
                    "í•™ìš©í’ˆ, ê°„ì‹ë¥˜, ìŒë£Œ ë“±ì„ íŒë§¤í•©ë‹ˆë‹¤."
                ],
                "2ì¸µ": [
                    "êµìˆ˜ì‹ë‹¹",
                    "í‰ì¼ 11:30-13:30",
                    "ì „í™”ë²ˆí˜¸: 041-620-9578",
                    "ì¡°ìš©í•œ ë¶„ìœ„ê¸°ì—ì„œ ì‹ì‚¬ë¥¼ ì œê³µí•˜ë©° í’ˆì§ˆ ë†’ì€ ë©”ë‰´ê°€ ì¤€ë¹„ë©ë‹ˆë‹¤."
                ]
            }
        },

        "ëª©ì–‘ê´€": {
            floors: {
                "1ì¸µ": [
                    "ë³µì‚¬ì ",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-561-0722",
                    "ì¶œë ¥, ì œë³¸, ë³µì‚¬ ë“±ì˜ ë¬¸ì„œ ì‘ì—… ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤."
                ],
                "3~5ì¸µ": [
                    "íœ´ê²Œì‹¤",
                    "24ì‹œê°„",
                    "í•™ìƒë“¤ì´ ìˆ˜ì—… ì‚¬ì´ì— íœ´ì‹í•  ìˆ˜ ìˆëŠ” ê³µê°„ì…ë‹ˆë‹¤."
                ],
                "5ì¸µ": [
                    "ê°œë°©ì „ì‚°ì‹¤",
                    "í‰ì¼ 09:00-18:00",
                    "í•™ìƒë“¤ì´ ììœ ë¡­ê²Œ ì»´í“¨í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê³µê°„ì…ë‹ˆë‹¤."
                ]
            }
        },

        "í†µí•™ë²„ìŠ¤ ìŠ¹ì°¨ì¥": {
            floors: {
                "í†µí•™ë²„ìŠ¤ ìŠ¹ì°¨ì¥": [
                    "ì‹ ì •ê´€ê´‘ / ë¸”ë£¨ê´€ê´‘",
                    "í‰ì¼ 07:00-22:00",
                    "ì „í™”ë²ˆí˜¸: 041-567-3001",
                    "í•™ìƒë“¤ì˜ í†µí•™ì„ ì§€ì›í•˜ëŠ” ë²„ìŠ¤ ìš´í–‰ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤."
                ]
            }
        },

        "ì§„ë¦¬ê´€": {
            floors: {
                "1ì¸µ": [
                    "ìš°ì²´êµ­",
                    "í‰ì¼ 09:00-17:00",
                    "ì „í™”ë²ˆí˜¸: 041-550-0730",
                    "ìš°í¸ ë°œì†¡, íƒë°° ì ‘ìˆ˜, ê¸ˆìœµ ê´€ë ¨ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤."
                ,
                    "ì„œì ",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-550-9198",
                    "êµì¬, ë¬¸êµ¬ë¥˜, í•™ìŠµìš© ë„ì„œë¥¼ êµ¬ë§¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                ,
                    "ë³µì‚¬ê¸°",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-550-0722",
                    "í•™ìƒë“¤ì˜ ê¸°ë³¸ì ì¸ ì¶œë ¥ ë° ë³µì‚¬ ì‘ì—…ì„ ì§€ì›í•©ë‹ˆë‹¤."
                ,
                    "ë³´ê±´ì‹¤",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-550-0722",
                    "í•™ìƒë“¤ì˜ ê¸°ë³¸ì ì¸ ì‘ê¸‰ ì²˜ì¹˜ì™€ ìƒë‹´ì„ ì§€ì›í•©ë‹ˆë‹¤."
                ,
                    "ì—¬í•™ìƒíšŒë³µì‹¤",
                    "í‰ì¼ 09:00-18:00",
                    "ì—¬í•™ìƒë“¤ì„ ìœ„í•œ ì „ìš© íœ´ì‹ ê³µê°„ì…ë‹ˆë‹¤."
                ],
                "3ì¸µ": [
                    "ë³µì‚¬ê¸°",
                    "í‰ì¼ 09:00-18:00",
                    "ì „í™”ë²ˆí˜¸: 041-550-0722",
                    "í•™ìƒë“¤ì˜ ê¸°ë³¸ì ì¸ ì¶œë ¥ ë° ë³µì‚¬ ì‘ì—…ì„ ì§€ì›í•©ë‹ˆë‹¤."
                ]
            }
        },

        "ì¸ì„±ê´€": {
            floors: {
                "1ì¸µ ë¡œë¹„": [
                    "ì¦ëª…ì„œ ë°œê¸‰ê¸°",
                    "24ì‹œê°„",
                    "ì „í™”ë²ˆí˜¸: 041-550-0780",
                    "ê°ì¢… í•™êµ ì¦ëª…ì„œë¥¼ ìë™ìœ¼ë¡œ ë°œê¸‰í•©ë‹ˆë‹¤."
                ]
            }
        }
    };

    /* ---------------------------
     * ê°€ìŠ¤í í•˜ìš°ìŠ¤ë§Œ detail.htmlë¡œ ì´ë™í•˜ë„ë¡ ë³€ê²½ëœ ë¶€ë¶„
     * --------------------------- */
    function showDetailPanel(name) {
        var panel = document.getElementById("detail-panel");
        var bg = document.getElementById("detail-panel-bg");

        var data = buildingDetails[name];
        var html = `<div class="close-btn" onclick="closeDetail()">âœ•</div>
                    <h2>${name}</h2>`;

        if (data) {
            Object.keys(data.floors).forEach(floor => {
                html += `
                <div class="floor-title" onclick="toggleFloor('${floor}')">${floor}</div>
                <div class="floor-content" id="floor-${floor}">
                `;

                html += data.floors[floor].map(v => {
                    if (v === "ê°€ìŠ¤í í•˜ìš°ìŠ¤") {
                        return `<div>- <a href="detail" style="color:#1d4ed8; text-decoration:underline;">${v}</a></div>`;
                    }
                    return `<div>- ${v}</div>`;
                }).join("");

                html += `</div>`;
            });
        } else {
            html += "<p>ë“±ë¡ëœ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>";
        }

        panel.innerHTML = html;
        panel.classList.add("open");
        bg.style.display = "block";
    }

    function closeDetail() {
        document.getElementById("detail-panel").classList.remove("open");
        document.getElementById("detail-panel-bg").style.display = "none";
    }

    document.getElementById("detail-panel-bg").addEventListener("click", closeDetail);

    function toggleFloor(f) {
        var el = document.getElementById("floor-" + f);
        el.style.display = el.style.display === "block" ? "none" : "block";
    }
</script>

</body>
</html>
