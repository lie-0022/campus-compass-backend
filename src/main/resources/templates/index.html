<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>Campus Compass</title>

    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: 'Pretendard', sans-serif;
            background: #f5f7fb;
        }

        /* ìƒë‹¨ í—¤ë” */
        .header {
            width: 100%;
            padding: 15px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-sizing: border-box;
            background: #ffffff;
            font-size: 20px;
            font-weight: bold;
            color: #1d4ed8;
        }

        .home-icon {
            font-size: 22px;
            cursor: pointer;
        }

        /* ê²€ìƒ‰ì°½ */
        .search-wrapper {
            width: 100%;
            padding: 10px 20px;
            box-sizing: border-box;
        }

        .search-box {
            width: 100%;
            height: 45px;
            padding: 0 15px;
            border-radius: 12px;
            border: 1px solid #d0d5dd;
            font-size: 14px;
            outline: none;
        }

        /* ì¹´í…Œê³ ë¦¬ */
        .category-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 0 20px;
        }

        .category-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            background: #ffffff;
            border-radius: 40px;
            border: 1px solid #d1d5db;
            font-size: 14px;
            cursor: pointer;
        }

        .category-btn.active {
            background: #1d4ed8;
            color: white;
            border: none;
        }

        .category-icon {
            font-size: 15px;
        }

        /* ì§€ë„ ë°•ìŠ¤ */
        #map-wrapper {
            width: calc(100% - 40px);
            height: calc(100% - 260px);
            background: white;
            border-radius: 14px;
            margin: 15px auto;
            box-shadow: 0 2px 6px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        #map {
            width: 100%;
            height: 100%;
        }

        /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ */
        .bottom-nav {
            width: 100%;
            height: 70px;
            background: white;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-around;
            align-items: center;
            position: fixed;
            bottom: 0;
            left: 0;
        }

        .nav-item {
            text-align: center;
            color: #6b7280;
            cursor: pointer;
        }

        .nav-icon {
            font-size: 22px;
            margin-bottom: 4px;
        }

        .nav-item.active {
            color: #1d4ed8;
        }

        /* ìƒì„¸ íŒ¨ë„ */
        #detail-panel-bg {
            position: fixed;
            width: 100%;
            height: 100%;
            left: 0; top: 0;
            background: rgba(0,0,0,0.25);
            display: none;
            z-index: 9998;
        }

        #detail-panel {
            position: fixed;
            bottom: 0;
            width: 100%;
            max-height: 65%;
            background: white;
            padding: 20px;
            border-radius: 20px 20px 0 0;
            box-shadow: 0 -2px 12px rgba(0,0,0,0.2);
            transform: translateY(100%);
            transition: .3s ease-out;
            z-index: 9999;
            overflow-y: auto;
        }

        #detail-panel.open {
            transform: translateY(0);
        }

        .floor-title {
            margin-top: 12px;
            font-size: 15px;
            font-weight: bold;
            cursor: pointer;
        }

        .floor-content {
            display: none;
            font-size: 14px;
            margin-left: 10px;
        }

        .close-btn {
            position: absolute;
            right: 18px;
            top: 14px;
            font-size: 20px;
            cursor: pointer;
        }

        .info-window {
            padding: 5px;
            font-size: 13px;
            font-weight: bold;
        }
    </style>
</head>

<body>

<!-- í—¤ë” -->
<div class="header">
    Campus Compass
    <div class="home-icon" onclick="location.href='/login'">ğŸ </div>
</div>

<!-- ê²€ìƒ‰ -->
<div class="search-wrapper">
    <input type="text" class="search-box" placeholder="ì‹œì„¤ëª… ê²€ìƒ‰...">
</div>

<!-- ì¹´í…Œê³ ë¦¬ -->
<div class="category-container">
    <div class="category-btn active"><span class="category-icon">ğŸ§­</span> ì „ì²´</div>
    <div class="category-btn"><span class="category-icon">â˜•</span> ì¹´í˜</div>
    <div class="category-btn"><span class="category-icon">ğŸ´</span> ì‹ë‹¹</div>
    <div class="category-btn"><span class="category-icon">ğŸ“š</span> ë„ì„œê´€</div>
    <div class="category-btn"><span class="category-icon">ğŸª</span> í¸ì˜ì </div>
    <div class="category-btn"><span class="category-icon">ğŸ›‹</span> íœ´ê²Œì‹¤</div>
    <div class="category-btn"><span class="category-icon">ğŸŸ</span> ì²´ìœ¡ê´€</div>
    <div class="category-btn"><span class="category-icon">â›‘</span> ì˜ë¬´ì‹¤</div>
    <div class="category-btn"><span class="category-icon">ğŸšŒ</span> í†µí•™ë²„ìŠ¤</div>
    <div class="category-btn"><span class="category-icon">ğŸ§</span> ATM</div>
</div>

<!-- ì§€ë„ -->
<div id="map-wrapper">
    <div id="map"></div>
</div>

<!-- ìƒì„¸ íŒ¨ë„ -->
<div id="detail-panel-bg"></div>
<div id="detail-panel"></div>

<!-- í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ -->
<div class="bottom-nav">
    <div class="nav-item active">
        <div class="nav-icon">ğŸ—º</div>
        ì§€ë„
    </div>
    <div class="nav-item">
        <div class="nav-icon">â¤ï¸</div>
        ì¦ê²¨ì°¾ê¸°
    </div>
    <div class="nav-item">
        <div class="nav-icon">âš™ï¸</div>
        ì„¤ì •
    </div>
</div>


<script src="http://dapi.kakao.com/v2/maps/sdk.js?appkey=62ce24f8a9799f9545de678f7cd4fb4c"></script>

<script>
    var map = new kakao.maps.Map(document.getElementById('map'), {
        center: new kakao.maps.LatLng(36.8392, 127.1835),
        level: 3
    });

    /* buildingDetails, showDetailPanel(), closeDetail(), toggleFloor() ë“±
       ê¸°ì¡´ ê·¸ëŒ€ë¡œ ìœ ì§€ */
    var buildingDetails = {
        "ë³¸ë¶€ë™": {
            floors: {
                "ì§€í•˜ 1ì¸µ": ["ê°€ìŠ¤í í•˜ìš°ìŠ¤", "í‰ì¼ 08:00-19:00", "ì „í™”ë²ˆí˜¸:041-550-0858"],
                "1ì¸µ": ["ë„ì„œê´€", "í‰ì¼ 09:00-18:00"],
                "3~9ì¸µ": ["ë¼ìš´ì§€"],
                "6ì¸µ": ["ë§¤ì "],
                "6,8ì¸µ ë¡œë¹„": ["ë³µì‚¬ê¸°"]
            }
        },
        "ë°±ì„ìƒí™œê´€": {
            floors: {
                "1ì¸µ": ["ì‹ë‹¹", "í‰ì¼ 07:30-09:00, 11:30-13:00, 17:30-19:00", "ì „í™”ë²ˆí˜¸: 010-8805-1215"]
            }
        },
        "ì˜ˆìˆ ë™": {
            floors: {
                "1,7ì¸µ ë¡œë¹„": ["ë³µì‚¬ê¸°"],
                "5ì¸µ": ["ë§¤ì "]
            }
        },
        "êµìˆ˜íšŒê´€": {
            floors: {
                "1ì¸µ": ["ì‹ë‹¹"],
                "1ì¸µ(ì‹ë‹¹ ì•ˆ)": ["ë§¤ì "],
                "2ì¸µ": ["êµìˆ˜ì‹ë‹¹"]
            }
        },
        "ëª©ì–‘ê´€": {
            floors: {
                "1ì¸µ": ["ë³µì‚¬ì "],
                "3~5ì¸µ": ["íœ´ê²Œì‹¤"],
                "5ì¸µ": ["ê°œë°©ì „ì‚°ì‹¤"]
            }
        },
        "í†µí•™ë²„ìŠ¤ ìŠ¹ì°¨ì¥": {
            floors: {
                "ì‹ ì •ê´€ê´‘/ë¸”ë£¨ê´€ê´‘": ["ì‹ ì •ê´€ê´‘/ë¸”ë£¨ê´€ê´‘"]
            }
        },
        "ì§„ë¦¬ê´€": {
            floors: {
                "1ì¸µ": ["ê°€ìŠ¤í í•˜ìš°ìŠ¤", "ìš°ì²´êµ­", "ì„œì ", "ë³´ê±´ì‹¤", "ì—¬í•™ìƒíšŒë³µì‹¤"],
                "3ì¸µ ë³„ê´€": ["ë³µì‚¬ê¸°"]
            }
        },
        "ì¸ì„±ê´€": {
            floors: {
                "1ì¸µ ë¡œë¹„": ["ì¦ëª…ì„œ ë°œê¸‰ê¸°"]
            }
        }
    };

    function showDetailPanel(name) {
        var panel = document.getElementById("detail-panel");
        var bg = document.getElementById("detail-panel-bg");

        var data = buildingDetails[name];
        var html = `<div class="close-btn" onclick="closeDetail()">âœ•</div><h2>${name}</h2>`;

        if (data) {
            Object.keys(data.floors).forEach(function(floor) {
                html += `
                <div class="floor-title" onclick="toggleFloor('${floor}')">${floor}</div>
                <div class="floor-content" id="floor-${floor}">
                    ${data.floors[floor].map(item => {
                        if(item === "ê°€ìŠ¤í í•˜ìš°ìŠ¤") {
                            return `<div>- <a href="/detail" style="color:#1d4ed8; font-weight:bold;">${item}</a></div>`;
                        }
                        return `<div>- ${item}</div>`;
                    }).join("")}
                </div>
                `;
            });
        }

        panel.innerHTML = html;
        panel.classList.add("open");
        bg.style.display = "block";
    }

    function closeDetail() {
        document.getElementById("detail-panel").classList.remove("open");
        document.getElementById("detail-panel-bg").style.display = "none";
    }

    document.getElementById("detail-panel-bg").addEventListener("click", closeDetail);

    function toggleFloor(floor) {
        var el = document.getElementById("floor-" + floor);
        el.style.display = el.style.display === "block" ? "none" : "block";
    }

    /* ë§ˆì»¤ ìƒì„± */
    function createMarker(lat, lng, name) {
        var marker = new kakao.maps.Marker({
            position: new kakao.maps.LatLng(lat, lng),
            map: map
        });

        var infowindow = new kakao.maps.InfoWindow({
            content: `<div class="info-window">${name}</div>`
        });

        kakao.maps.event.addListener(marker, 'mouseover', function () {
            infowindow.open(map, marker);
        });
        kakao.maps.event.addListener(marker, 'mouseout', function () {
            infowindow.close();
        });
        kakao.maps.event.addListener(marker, 'click', function () {
            showDetailPanel(name);
        });

        return marker;
    }

    /* ë§ˆì»¤ ëª©ë¡ */
    var extraBuildings = [
        { name: "ë°±ì„ìƒí™œê´€", latitude: 36.842416868120225, longitude: 127.18524566858616 },
        { name: "ì˜ˆìˆ ë™", latitude: 36.83884502537989, longitude: 127.18745680215231 },
        { name: "êµìˆ˜íšŒê´€", latitude: 36.83968724481267, longitude: 127.18477943520088 },
        { name: "ëª©ì–‘ê´€", latitude: 36.84084689807044, longitude: 127.18366111087241 },
        { name: "í†µí•™ë²„ìŠ¤ ìŠ¹ì°¨ì¥", latitude: 36.841622951995234, longitude: 127.18294544630108 },
        { name: "ì¸ì„±ê´€", latitude: 36.839387303159945, longitude: 127.18353430049741 },
        { name: "ë³¸ë¶€ë™", latitude: 36.839315997059806, longitude: 127.18593046396421 },
        { name: "ì§„ë¦¬ê´€", latitude: 36.84020572676171, longitude: 127.18455646157217 }
    ];

    extraBuildings.forEach(b => createMarker(b.latitude, b.longitude, b.name));
</script>

</body>
</html>
